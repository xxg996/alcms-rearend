{
  "name": "管理员登录示例",
  "request": {
    "method": "POST",
    "header": [
      {
        "key": "Content-Type",
        "value": "application/json"
      }
    ],
    "body": {
      "mode": "raw",
      "raw": "{\n  \"email\": \"admin@alcms.com\",\n  \"password\": \"admin123\"\n}"
    },
    "url": {
      "raw": "{{baseUrl}}/api/auth/login",
      "host": ["{{baseUrl}}"],
      "path": ["api", "auth", "login"]
    },
    "description": "使用默认管理员账户登录\n\n### 默认管理员账户信息\n- **用户名**: admin\n- **邮箱**: admin@alcms.com\n- **密码**: admin123\n- **角色**: 系统管理员\n- **权限**: 拥有所有16个系统权限\n\n### 登录后可以执行的管理员操作\n- 查看所有用户列表\n- 获取用户统计信息\n- 更新用户状态（封禁/冻结/解封）\n- 分配和移除用户角色\n- 访问所有管理员专属接口\n\n### 安全提醒\n⚠️ 这是默认管理员账户，请在生产环境中：\n1. 立即修改默认密码\n2. 更改默认邮箱地址\n3. 启用多因素认证（如果支持）\n4. 定期审查管理员权限"
  },
  "response": [],
  "event": [
    {
      "listen": "test",
      "script": {
        "exec": [
          "// 测试管理员登录成功",
          "pm.test(\"Admin login successful\", function () {",
          "    pm.response.to.have.status(200);",
          "    const responseJson = pm.response.json();",
          "    pm.expect(responseJson.success).to.be.true;",
          "    pm.expect(responseJson.message).to.equal('登录成功');",
          "});",
          "",
          "// 验证管理员角色",
          "pm.test(\"User has admin role\", function () {",
          "    const responseJson = pm.response.json();",
          "    const roles = responseJson.data.user.roles;",
          "    const hasAdminRole = roles.some(role => role.name === 'admin');",
          "    pm.expect(hasAdminRole).to.be.true;",
          "});",
          "",
          "// 保存管理员令牌",
          "if (pm.response.code === 200) {",
          "    const responseJson = pm.response.json();",
          "    pm.environment.set('adminAccessToken', responseJson.data.tokens.accessToken);",
          "    pm.environment.set('adminRefreshToken', responseJson.data.tokens.refreshToken);",
          "    pm.environment.set('adminUserId', responseJson.data.user.id);",
          "    console.log('Admin tokens saved to environment');",
          "    ",
          "    // 立即测试管理员权限",
          "    pm.sendRequest({",
          "        url: pm.environment.get('baseUrl') + '/api/users',",
          "        method: 'GET',",
          "        header: {",
          "            'Authorization': 'Bearer ' + responseJson.data.tokens.accessToken",
          "        }",
          "    }, function (err, response) {",
          "        if (!err && response.code === 200) {",
          "            pm.test('Admin can access user list', function() {",
          "                pm.expect(response.code).to.equal(200);",
          "                const userData = response.json();",
          "                pm.expect(userData.data.users).to.be.an('array');",
          "                console.log('Admin access verified: can view ' + userData.data.users.length + ' users');",
          "            });",
          "        }",
          "    });",
          "}"
        ]
      }
    }
  ]
}
