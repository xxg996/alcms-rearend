# Alcms CMS èµ„æºç®¡ç†ç³»ç»Ÿ

ä¸€ä¸ªåŸºäº Node.js + Express.js + PostgreSQL æ„å»ºçš„ç°ä»£åŒ–å†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œé›†æˆäº†å®Œæ•´çš„ç”¨æˆ·æƒé™ç®¡ç†å’Œå¤šåª’ä½“èµ„æºç®¡ç†åŠŸèƒ½ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ” å®‰å…¨è®¤è¯
- **JWT åŒä»¤ç‰Œæœºåˆ¶**ï¼šè®¿é—®ä»¤ç‰Œ + åˆ·æ–°ä»¤ç‰Œ
- **å¯†ç å®‰å…¨**ï¼šbcrypt åŠ ç›å“ˆå¸Œï¼Œå¯é…ç½®å¼ºåº¦
- **è¯·æ±‚é¢‘ç‡é™åˆ¶**ï¼šé˜²æ­¢æš´åŠ›æ”»å‡»å’Œæ¶æ„è¯·æ±‚
- **è¾“å…¥éªŒè¯**ï¼šSQL æ³¨å…¥é˜²æŠ¤ã€XSS é˜²æŠ¤
- **å®‰å…¨å¤´è®¾ç½®**ï¼šHelmet ä¸­é—´ä»¶æä¾›å¤šé‡å®‰å…¨é˜²æŠ¤

### ğŸ‘¥ ç”¨æˆ·ç®¡ç†
- **ç”¨æˆ·æ³¨å†Œ**ï¼šé‚®ç®± + ç”¨æˆ·åéªŒè¯
- **ç”¨æˆ·ç™»å½•**ï¼šé‚®ç®±å¯†ç è®¤è¯
- **èµ„æ–™ç®¡ç†**ï¼šå¤´åƒã€æ˜µç§°ã€ç®€ä»‹ä¿®æ”¹
- **çŠ¶æ€æ§åˆ¶**ï¼šæ­£å¸¸ / å°ç¦ / å†»ç»“çŠ¶æ€ç®¡ç†

### ğŸ›¡ï¸ æƒé™æ§åˆ¶
- **RBAC æ¨¡å‹**ï¼šåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
- **å››çº§è§’è‰²ä½“ç³»**ï¼š
  - æ™®é€šç”¨æˆ·ï¼šåŸºç¡€åŠŸèƒ½æƒé™
  - VIP ç”¨æˆ·ï¼šé«˜çº§åŠŸèƒ½æƒé™
  - ç‰ˆä¸»ï¼šå†…å®¹ç®¡ç†æƒé™
  - ç®¡ç†å‘˜ï¼šç³»ç»Ÿç®¡ç†æƒé™
- **ç»†ç²’åº¦æƒé™**ï¼šèµ„æº + åŠ¨ä½œçš„æƒé™æ§åˆ¶
- **åŠ¨æ€æƒé™æ£€æŸ¥**ï¼šä¸­é—´ä»¶çº§åˆ«çš„æƒé™éªŒè¯

### ğŸ’ VIPä¼šå‘˜ç³»ç»Ÿ
- **å¤šçº§VIPç­‰çº§**ï¼šæ”¯æŒ1-3çº§VIPï¼Œæƒé™é€’å¢
- **çµæ´»æœ‰æ•ˆæœŸ**ï¼šæ”¯æŒå¤©æ•°VIPå’Œæ°¸ä¹…VIP
- **å¡å¯†å…‘æ¢ç³»ç»Ÿ**ï¼šç”Ÿæˆå’Œç®¡ç†VIPå¡å¯†
- **è‡ªåŠ¨è¿‡æœŸå¤„ç†**ï¼šå®šæ—¶ä»»åŠ¡è‡ªåŠ¨æ›´æ–°è¿‡æœŸç”¨æˆ·çŠ¶æ€
- **è®¢å•è®°å½•**ï¼šå®Œæ•´çš„VIPè´­ä¹°å’Œä½¿ç”¨è®°å½•

### ğŸ« å¡å¯†ç³»ç»Ÿ
- **åŒç±»å‹æ”¯æŒ**ï¼šVIPå¡å¯†å’Œç§¯åˆ†å¡å¯†
- **æ‰¹é‡ç”Ÿæˆ**ï¼šæ”¯æŒä¸€æ¬¡ç”Ÿæˆ1-1000ä¸ªå¡å¯†
- **çŠ¶æ€ç®¡ç†**ï¼šæœªä½¿ç”¨/å·²ä½¿ç”¨/å·²è¿‡æœŸ/å·²ç¦ç”¨
- **ä½¿ç”¨è®°å½•**ï¼šè¯¦ç»†çš„å…‘æ¢å†å²å’Œç»Ÿè®¡
- **è¿‡æœŸæ§åˆ¶**ï¼šå¯è®¾ç½®å¡å¯†æœ‰æ•ˆæœŸ

### ğŸ¯ ç§¯åˆ†ç³»ç»Ÿ
- **ç§¯åˆ†è·å–**ï¼šç­¾åˆ°ã€ä»»åŠ¡ã€ç®¡ç†å‘˜å‘æ”¾ç­‰å¤šç§æ–¹å¼
- **ç§¯åˆ†æ¶ˆè´¹**ï¼šèµ„æºä¸‹è½½ã€åŠŸèƒ½è§£é”ç­‰
- **è½¬è´¦åŠŸèƒ½**ï¼šç”¨æˆ·é—´ç§¯åˆ†è½¬ç§»ï¼ˆå•æ¬¡æœ€å¤š10000ï¼‰
- **ç§¯åˆ†è®°å½•**ï¼šå®Œæ•´çš„ç§¯åˆ†å˜åŠ¨å†å²
- **æ’è¡Œæ¦œç³»ç»Ÿ**ï¼šå®æ—¶ç§¯åˆ†æ’å

### âœ… ç­¾åˆ°ç³»ç»Ÿ
- **æ¯æ—¥ç­¾åˆ°**ï¼šç”¨æˆ·æ¯å¤©å¯ç­¾åˆ°ä¸€æ¬¡è·å¾—ç§¯åˆ†
- **è¿ç»­å¥–åŠ±**ï¼š7å¤©ã€15å¤©ã€30å¤©è¿ç»­ç­¾åˆ°é¢å¤–å¥–åŠ±
- **ç­¾åˆ°ç»Ÿè®¡**ï¼šä¸ªäººç­¾åˆ°å†å²å’Œç»Ÿè®¡æ•°æ®
- **ç®¡ç†åŠŸèƒ½**ï¼šç­¾åˆ°é…ç½®ç®¡ç†ã€ç”¨æˆ·ç­¾åˆ°æ•°æ®ç®¡ç†
- **è¡¥ç­¾åŠŸèƒ½**ï¼šç®¡ç†å‘˜å¯ä¸ºç”¨æˆ·è¡¥ç­¾å†å²æ—¥æœŸ

### â­ æ”¶è—ç³»ç»Ÿ
- **èµ„æºæ”¶è—**ï¼šç”¨æˆ·å¯æ”¶è—å–œæ¬¢çš„èµ„æº
- **æ”¶è—ç®¡ç†**ï¼šæŸ¥çœ‹ã€æœç´¢ã€æ‰¹é‡ç®¡ç†æ”¶è—
- **æ”¶è—ç»Ÿè®¡**ï¼šä¸ªäººå’Œèµ„æºçš„æ”¶è—ç»Ÿè®¡
- **çƒ­é—¨åˆ†æ**ï¼šç®¡ç†å‘˜å¯æŸ¥çœ‹çƒ­é—¨æ”¶è—èµ„æº

### ğŸ“„ CMS èµ„æºç®¡ç†
- **å¤šåª’ä½“æ”¯æŒ**ï¼šæ–‡ç« ã€è§†é¢‘ã€éŸ³é¢‘ã€å›¾ç‰‡ã€æ–‡æ¡£ã€è½¯ä»¶ã€ç”µå­ä¹¦
- **åˆ†ç±»ç®¡ç†**ï¼šæ— é™å±‚çº§çš„æ ‘å½¢åˆ†ç±»ç»“æ„
- **æ ‡ç­¾ç³»ç»Ÿ**ï¼šå¤šæ ‡ç­¾æ”¯æŒï¼Œæ™ºèƒ½æ ‡ç­¾æœç´¢å’Œç»Ÿè®¡
- **æƒé™æ§åˆ¶**ï¼šVIPæƒé™ã€ç§¯åˆ†æ¶ˆè€—ã€ä¸‹è½½æ¬¡æ•°é™åˆ¶
- **é˜²ç›—é“¾ä¿æŠ¤**ï¼šç­¾åé“¾æ¥ã€IPéªŒè¯ã€æ—¶æ•ˆæ§åˆ¶
- **å…¨æ–‡æœç´¢**ï¼šPostgreSQL GINç´¢å¼•æ”¯æŒçš„é«˜æ•ˆæœç´¢
- **ç»Ÿè®¡åˆ†æ**ï¼šèµ„æºè®¿é—®ã€ä¸‹è½½ç»Ÿè®¡ï¼Œçƒ­é—¨å†…å®¹åˆ†æ

### ğŸ” æœç´¢åŠŸèƒ½
- **å…¨æ–‡æœç´¢**ï¼šæ ‡é¢˜ã€æè¿°ã€å†…å®¹æ™ºèƒ½æœç´¢
- **é«˜çº§ç­›é€‰**ï¼šåˆ†ç±»ã€æ ‡ç­¾ã€çŠ¶æ€ã€ä»·æ ¼ç»„åˆç­›é€‰
- **ç›¸å…³åº¦æ’åº**ï¼šæŒ‰ç›¸å…³åº¦ã€æ—¶é—´ã€çƒ­åº¦ç­‰å¤šç»´åº¦æ’åº
- **æœç´¢å»ºè®®**ï¼šæ ‡ç­¾è”æƒ³å’Œçƒ­é—¨æœç´¢æ¨è

### ğŸ’¬ å¾®ç¤¾åŒºç³»ç»Ÿ
- **æ¿å—ç®¡ç†**ï¼šæ— é™å±‚çº§æ¿å—ç»“æ„ï¼Œç‰ˆä¸»ç®¡ç†æœºåˆ¶
- **å¸–å­å‘å¸ƒ**ï¼šæ”¯æŒMarkdown/HTMLæ ¼å¼ï¼Œç½®é¡¶ç²¾ååŠŸèƒ½
- **æ¥¼ä¸­æ¥¼è¯„è®º**ï¼šæ— é™åµŒå¥—è¯„è®ºç»“æ„ï¼Œ@ç”¨æˆ·åŠŸèƒ½
- **äº’åŠ¨åŠŸèƒ½**ï¼šç‚¹èµã€æ”¶è—ã€åˆ†äº«ã€ä¸¾æŠ¥ç³»ç»Ÿ
- **ç¤¾åŒºæ²»ç†**ï¼šå†…å®¹å®¡æ ¸ã€è¿è§„å¤„ç½šã€æƒé™æ§åˆ¶
- **å…¨æ–‡æœç´¢**ï¼šPostgreSQL GINç´¢å¼•é«˜æ€§èƒ½æœç´¢
- **å®æ—¶ç»Ÿè®¡**ï¼šå¸–å­ã€è¯„è®ºã€äº’åŠ¨æ•°æ®è‡ªåŠ¨ç»Ÿè®¡

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### åç«¯æŠ€æœ¯æ ˆ
- **è¿è¡Œç¯å¢ƒ**ï¼šNode.js (>=16.0.0)
- **Web æ¡†æ¶**ï¼šExpress.js 4.x
- **æ•°æ®åº“**ï¼šPostgreSQL (>=12.0)
- **ç¼“å­˜**ï¼šRedis (>=6.0, å¯é€‰)
- **è®¤è¯**ï¼šJSON Web Token (JWT)
- **å¯†ç åŠ å¯†**ï¼šbcrypt
- **è¾“å…¥éªŒè¯**ï¼šexpress-validator
- **å®‰å…¨é˜²æŠ¤**ï¼šhelmet, cors, express-rate-limit
- **API æ–‡æ¡£**ï¼šSwagger/OpenAPI 3.0
- **æ—¥å¿—ç³»ç»Ÿ**ï¼šWinston
- **è¿›ç¨‹ç®¡ç†**ï¼šPM2 é›†ç¾¤æ¨¡å¼
- **æ€§èƒ½ç›‘æ§**ï¼šè‡ªå®šä¹‰ä¸­é—´ä»¶

### ğŸ“ é¡¹ç›®ç»“æ„
```
alcms-rearend/
â”œâ”€â”€ src/                    # ğŸ¯ æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ app.js             # ğŸš€ åº”ç”¨å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ cluster.js         # âš¡ é›†ç¾¤æ¨¡å¼å¯åŠ¨æ–‡ä»¶
â”‚   â”œâ”€â”€ config/            # âš™ï¸ é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ database.js    # ğŸ—„ï¸ æ•°æ®åº“é…ç½®
â”‚   â”‚   â”œâ”€â”€ minio.js       # ğŸ“¦ MinIO å¯¹è±¡å­˜å‚¨é…ç½®
â”‚   â”‚   â””â”€â”€ swagger.js     # ğŸ“š APIæ–‡æ¡£é…ç½®
â”‚   â”œâ”€â”€ controllers/       # ğŸ® æ§åˆ¶å™¨å±‚ (ä¸šåŠ¡é€»è¾‘å…¥å£)
â”‚   â”‚   â”œâ”€â”€ authController.js              # ğŸ” ç”¨æˆ·è®¤è¯æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ userController.js              # ğŸ‘¥ ç”¨æˆ·ç®¡ç†æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ vipController.js               # ğŸ’ VIPä¼šå‘˜ç³»ç»Ÿæ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ cardKeyController.js           # ğŸ« å¡å¯†ç³»ç»Ÿæ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ pointsController.js            # ğŸ¯ ç§¯åˆ†ç³»ç»Ÿæ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ checkinController.js           # âœ… ç­¾åˆ°ç³»ç»Ÿæ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ favoriteController.js          # â­ æ”¶è—ç³»ç»Ÿæ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ resourceController.js          # ğŸ“„ èµ„æºç®¡ç†æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ categoryController.js          # ğŸ“‚ åˆ†ç±»ç®¡ç†æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ tagController.js               # ğŸ·ï¸ æ ‡ç­¾ç®¡ç†æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ rolePermissionController.js    # ğŸ›¡ï¸ è§’è‰²æƒé™ç®¡ç†æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ uploadController.js            # ğŸ“¤ æ–‡ä»¶ä¸Šä¼ æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ presignedUploadController.js   # ğŸ”— é¢„ç­¾åä¸Šä¼ æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ communityBoardController.js    # ğŸ’¬ ç¤¾åŒºæ¿å—ç®¡ç†æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ communityPostController.js     # ğŸ“ ç¤¾åŒºå¸–å­ç®¡ç†æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ communityCommentController.js  # ğŸ’­ ç¤¾åŒºè¯„è®ºç®¡ç†æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ communityInteractionController.js # ğŸ‘ ç¤¾åŒºäº’åŠ¨åŠŸèƒ½æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ middleware/        # ğŸ”§ ä¸­é—´ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ auth.js        # ğŸ”‘ JWTè®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ authOptimized.js # âš¡ ä¼˜åŒ–è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ cacheMiddleware.js # ğŸ’¾ ç¼“å­˜ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ errorHandler.js    # âŒ é”™è¯¯å¤„ç†ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ httpCache.js       # ğŸŒ HTTPç¼“å­˜ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ performance.js     # ğŸ“Š æ€§èƒ½ç›‘æ§ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ permission.js      # ğŸ›¡ï¸ æƒé™æ£€æŸ¥ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ rateLimitAdvanced.js # â±ï¸ é«˜çº§é™æµä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ security.js        # ğŸ”’ å®‰å…¨é˜²æŠ¤ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ validation.js      # âœ… è¾“å…¥éªŒè¯ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ models/            # ğŸ“Š æ•°æ®æ¨¡å‹å±‚
â”‚   â”‚   â”œâ”€â”€ User.js        # ğŸ‘¥ ç”¨æˆ·æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ VIP.js         # ğŸ’ VIPä¼šå‘˜æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ CardKey.js     # ğŸ« å¡å¯†æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ Points.js      # ğŸ¯ ç§¯åˆ†æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ Checkin.js     # âœ… ç­¾åˆ°æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ Favorite.js    # â­ æ”¶è—æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ Resource.js    # ğŸ“„ èµ„æºæ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ Category.js    # ğŸ“‚ åˆ†ç±»æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ Tag.js         # ğŸ·ï¸ æ ‡ç­¾æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ Role.js        # ğŸ­ è§’è‰²æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ Permission.js  # ğŸ›¡ï¸ æƒé™æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ CommunityBoard.js      # ğŸ’¬ ç¤¾åŒºæ¿å—æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ CommunityPost.js       # ğŸ“ ç¤¾åŒºå¸–å­æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ CommunityComment.js    # ğŸ’­ ç¤¾åŒºè¯„è®ºæ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ CommunityInteraction.js # ğŸ‘ ç¤¾åŒºäº’åŠ¨æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ routes/            # ğŸ›¤ï¸ è·¯ç”±å®šä¹‰å±‚
â”‚   â”‚   â”œâ”€â”€ auth.js        # ğŸ” ç”¨æˆ·è®¤è¯è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ users.js       # ğŸ‘¥ ç”¨æˆ·ç®¡ç†è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ vip.js         # ğŸ’ VIPä¼šå‘˜è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ cardKey.js     # ğŸ« å¡å¯†ç®¡ç†è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ points.js      # ğŸ¯ ç§¯åˆ†ç³»ç»Ÿè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ checkin.js     # âœ… ç­¾åˆ°ç³»ç»Ÿè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ favorites.js   # â­ æ”¶è—ç³»ç»Ÿè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ resources.js   # ğŸ“„ èµ„æºç®¡ç†è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ categories.js  # ğŸ“‚ åˆ†ç±»ç®¡ç†è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ tags.js        # ğŸ·ï¸ æ ‡ç­¾ç®¡ç†è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ rolePermissions.js # ğŸ›¡ï¸ è§’è‰²æƒé™è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ upload.js      # ğŸ“¤ æ–‡ä»¶ä¸Šä¼ è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ presignedUpload.js # ğŸ”— é¢„ç­¾åä¸Šä¼ è·¯ç”±
â”‚   â”‚   â””â”€â”€ community.js   # ğŸ’¬ ç¤¾åŒºåŠŸèƒ½è·¯ç”±
â”‚   â”œâ”€â”€ services/          # ğŸ—ï¸ ä¸šåŠ¡é€»è¾‘æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ index.js       # ğŸ“‹ æœåŠ¡å±‚å…¥å£
â”‚   â”‚   â”œâ”€â”€ BaseService.js # ğŸ›ï¸ åŸºç¡€æœåŠ¡ç±»
â”‚   â”‚   â”œâ”€â”€ AuthService.js # ğŸ” è®¤è¯ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ UserService.js # ğŸ‘¥ ç”¨æˆ·ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ VipService.js  # ğŸ’ VIPä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ CardKeyService.js      # ğŸ« å¡å¯†ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ PointsService.js       # ğŸ¯ ç§¯åˆ†ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ CheckinService.js      # âœ… ç­¾åˆ°ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ FavoriteService.js     # â­ æ”¶è—ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ResourceService.js     # ğŸ“„ èµ„æºä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ CategoryService.js     # ğŸ“‚ åˆ†ç±»ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ TagService.js          # ğŸ·ï¸ æ ‡ç­¾ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ CommunityService.js    # ğŸ’¬ ç¤¾åŒºä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ UploadService.js       # ğŸ“¤ ä¸Šä¼ ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ PresignedUploadService.js # ğŸ”— é¢„ç­¾åä¸Šä¼ æœåŠ¡
â”‚   â”‚   â””â”€â”€ ServiceFactory.js      # ğŸ­ æœåŠ¡å·¥å‚ç±»
â”‚   â”œâ”€â”€ docs/              # ğŸ“– APIæ–‡æ¡£Schemaå®šä¹‰
â”‚   â”‚   â””â”€â”€ schemas/       # ğŸ“‹ Swagger Schema å®šä¹‰
â”‚   â”‚       â”œâ”€â”€ common.js  # ğŸ”— é€šç”¨Schemaå®šä¹‰
â”‚   â”‚       â”œâ”€â”€ auth.js    # ğŸ” è®¤è¯Schemaå®šä¹‰
â”‚   â”‚       â”œâ”€â”€ user.js    # ğŸ‘¥ ç”¨æˆ·Schemaå®šä¹‰
â”‚   â”‚       â”œâ”€â”€ vip.js     # ğŸ’ VIP Schemaå®šä¹‰
â”‚   â”‚       â”œâ”€â”€ cardkey.js # ğŸ« å¡å¯†Schemaå®šä¹‰
â”‚   â”‚       â”œâ”€â”€ points.js  # ğŸ¯ ç§¯åˆ†Schemaå®šä¹‰
â”‚   â”‚       â”œâ”€â”€ checkin.js # âœ… ç­¾åˆ°Schemaå®šä¹‰
â”‚   â”‚       â”œâ”€â”€ favorite.js # â­ æ”¶è—Schemaå®šä¹‰
â”‚   â”‚       â”œâ”€â”€ resource.js # ğŸ“„ èµ„æºSchemaå®šä¹‰
â”‚   â”‚       â”œâ”€â”€ category.js # ğŸ“‚ åˆ†ç±»Schemaå®šä¹‰
â”‚   â”‚       â”œâ”€â”€ tag.js     # ğŸ·ï¸ æ ‡ç­¾Schemaå®šä¹‰
â”‚   â”‚       â”œâ”€â”€ rolePermission.js # ğŸ›¡ï¸ è§’è‰²æƒé™Schemaå®šä¹‰
â”‚   â”‚       â”œâ”€â”€ upload.js  # ğŸ“¤ ä¸Šä¼ Schemaå®šä¹‰
â”‚   â”‚       â””â”€â”€ community.js # ğŸ’¬ ç¤¾åŒºSchemaå®šä¹‰
â”‚   â””â”€â”€ utils/             # ğŸ› ï¸ å·¥å…·å‡½æ•°ç›®å½•
â”‚       â”œâ”€â”€ jwt.js         # ğŸ« JWTä»¤ç‰Œå·¥å…·
â”‚       â”œâ”€â”€ secureJwt.js   # ğŸ”’ å®‰å…¨JWTå·¥å…·
â”‚       â”œâ”€â”€ password.js    # ğŸ”‘ å¯†ç åŠ å¯†å·¥å…·
â”‚       â”œâ”€â”€ logger.js      # ğŸ“ æ—¥å¿—è®°å½•å·¥å…·
â”‚       â”œâ”€â”€ cache.js       # ğŸ’¾ ç¼“å­˜ç®¡ç†å·¥å…·
â”‚       â”œâ”€â”€ downloadUtils.js # ğŸ“¥ èµ„æºä¸‹è½½å·¥å…·
â”‚       â”œâ”€â”€ downloadUtilsBatch.js # ğŸ“¦ æ‰¹é‡ä¸‹è½½å·¥å…·
â”‚       â”œâ”€â”€ batchLoader.js # âš¡ æ‰¹é‡æ•°æ®åŠ è½½å™¨
â”‚       â”œâ”€â”€ queryOptimizer.js # ğŸš€ æŸ¥è¯¢ä¼˜åŒ–å™¨
â”‚       â””â”€â”€ responseHelper.js # ğŸ“¤ å“åº”æ ¼å¼åŒ–åŠ©æ‰‹
â”œâ”€â”€ database/              # ğŸ—„ï¸ æ•°æ®åº“ç›¸å…³æ–‡ä»¶
â”‚   â”œâ”€â”€ migrations/        # ğŸ“‹ æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ 001_create_tables.sql      # ğŸ‘¥ ç”¨æˆ·æƒé™è¡¨ç»“æ„
â”‚   â”‚   â”œâ”€â”€ 002_insert_default_data.sql # ğŸ‘¤ é»˜è®¤ç”¨æˆ·æ•°æ®
â”‚   â”‚   â”œâ”€â”€ 003_create_cms_tables.sql   # ğŸ“„ CMSæ ¸å¿ƒè¡¨ç»“æ„
â”‚   â”‚   â”œâ”€â”€ 004_insert_cms_default_data.sql # ğŸ“Š CMSé»˜è®¤æ•°æ®
â”‚   â”‚   â”œâ”€â”€ 005_create_community_tables.sql # ğŸ’¬ ç¤¾åŒºè¡¨ç»“æ„
â”‚   â”‚   â”œâ”€â”€ 006_insert_community_default_data.sql # ğŸ’¬ ç¤¾åŒºé»˜è®¤æ•°æ®
â”‚   â”‚   â”œâ”€â”€ 007_add_vip_card_system.sql # ğŸ’ VIPå¡å¯†ç³»ç»Ÿæ‰©å±•
â”‚   â”‚   â”œâ”€â”€ 008_add_points_checkin_system.sql # ğŸ¯ ç§¯åˆ†ç­¾åˆ°ç³»ç»Ÿæ‰©å±•
â”‚   â”‚   â”œâ”€â”€ 009_add_vip_points_permissions.sql # ğŸ›¡ï¸ VIPç§¯åˆ†æƒé™æ‰©å±•
â”‚   â”‚   â””â”€â”€ 010_add_permission_active_status.sql # âœ… æƒé™æ¿€æ´»çŠ¶æ€æ‰©å±•
â”‚   â”œâ”€â”€ scripts/           # ğŸ”§ æ•°æ®åº“ç®¡ç†è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ backup.js      # ğŸ’¾ æ•°æ®åº“å¤‡ä»½è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ restore.js     # â™»ï¸ æ•°æ®åº“æ¢å¤è„šæœ¬
â”‚   â”‚   â””â”€â”€ cleanup.js     # ğŸ§¹ æ•°æ®æ¸…ç†è„šæœ¬
â”‚   â”œâ”€â”€ check-tables-dynamic.js # ğŸ” åŠ¨æ€è¡¨æ£€æŸ¥å·¥å…·
â”‚   â”œâ”€â”€ install-full.js    # ğŸš€ å®Œæ•´å®‰è£…è„šæœ¬
â”‚   â””â”€â”€ optimize-database.sql # âš¡ æ•°æ®åº“ä¼˜åŒ–SQL
â”œâ”€â”€ logs/                  # ğŸ“‹ æ—¥å¿—æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ access/           # ğŸŒ è®¿é—®æ—¥å¿—
â”‚   â”œâ”€â”€ error/            # âŒ é”™è¯¯æ—¥å¿—
â”‚   â”œâ”€â”€ performance/      # ğŸ“Š æ€§èƒ½æ—¥å¿—
â”‚   â””â”€â”€ security/         # ğŸ”’ å®‰å…¨æ—¥å¿—
â”œâ”€â”€ scripts/               # ğŸ› ï¸ ç³»ç»Ÿç®¡ç†è„šæœ¬
â”‚   â”œâ”€â”€ create-admin.js    # ğŸ‘‘ åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·
â”‚   â”œâ”€â”€ system-health-check.js # ğŸ¥ ç³»ç»Ÿå¥åº·æ£€æŸ¥
â”‚   â””â”€â”€ replace-console-logs.js # ğŸ”„ æ—¥å¿—æ›¿æ¢å·¥å…·
â”œâ”€â”€ docs/                  # ğŸ“š é¡¹ç›®æ–‡æ¡£ç›®å½•
â”‚   â””â”€â”€ *.md              # ğŸ“– å„ç±»æ–‡æ¡£æ–‡ä»¶
â”œâ”€â”€ package.json           # ğŸ“¦ é¡¹ç›®ä¾èµ–é…ç½®
â”œâ”€â”€ package-lock.json      # ğŸ”’ ä¾èµ–ç‰ˆæœ¬é”å®š
â”œâ”€â”€ .env.example          # âš™ï¸ ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .gitignore            # ğŸš« Gitå¿½ç•¥æ–‡ä»¶é…ç½®
â”œâ”€â”€ ecosystem.config.js    # ğŸ”„ PM2è¿›ç¨‹ç®¡ç†é…ç½®
â”œâ”€â”€ setup-database.sql     # ğŸ—„ï¸ æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ CLAUDE.md             # ğŸ¤– Claude AIå·¥ä½œæŒ‡å¯¼æ–‡æ¡£
â”œâ”€â”€ README.md             # ğŸ“– é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ jwtä¼˜åŒ–.md            # ğŸ” JWTä¼˜åŒ–æ–‡æ¡£
â””â”€â”€ redisä¼˜åŒ–.md          # ğŸ’¾ Redisä¼˜åŒ–æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚
- Node.js >= 16.0.0
- PostgreSQL >= 12.0
- npm æˆ– yarn

### 2. å®‰è£…ä¾èµ–
```bash
npm install
```

### 3. ç¯å¢ƒé…ç½®
å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿å¹¶å¡«å†™é…ç½®ï¼š
```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®ä»¥ä¸‹å‚æ•°ï¼š

#### æ•°æ®åº“é…ç½®
```env
PGHOST=localhost
PGPORT=5432
PGDATABASE=alcms
PGUSER=your_username
PGPASSWORD=your_password
```

#### JWT é…ç½®
```env
JWT_SECRET=your_super_secure_jwt_secret_key_here
JWT_EXPIRES_IN=1h
JWT_REFRESH_SECRET=your_super_secure_refresh_secret_key_here
JWT_REFRESH_EXPIRES_IN=7d
```

#### æœåŠ¡å™¨é…ç½®
```env
PORT=3000
NODE_ENV=development
```

#### å®‰å…¨é…ç½®
```env
BCRYPT_ROUNDS=12
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
```

### 4. æ•°æ®åº“è®¾ç½®
ç¡®ä¿ PostgreSQL æœåŠ¡è¿è¡Œï¼Œå¹¶åˆ›å»ºæ•°æ®åº“ï¼š
```sql
CREATE DATABASE alcms;
```

**ğŸ“‹ è¿ç§»æ–‡ä»¶è¯´æ˜**ï¼š
- `001_create_tables.sql` - ğŸ‘¥ ç”¨æˆ·ã€è§’è‰²ã€æƒé™è¡¨
- `002_insert_default_data.sql` - ğŸ‘¤ é»˜è®¤è§’è‰²å’Œæƒé™æ•°æ®
- `003_create_cms_tables.sql` - ğŸ“„ CMS æ ¸å¿ƒè¡¨ï¼ˆèµ„æºã€åˆ†ç±»ã€æ ‡ç­¾ç­‰ï¼‰
- `004_insert_cms_default_data.sql` - ğŸ“Š CMS é»˜è®¤æ•°æ®ï¼ˆèµ„æºç±»å‹ã€åˆ†ç±»ç­‰ï¼‰
- `005_create_community_tables.sql` - ğŸ’¬ ç¤¾åŒºæ ¸å¿ƒè¡¨ï¼ˆæ¿å—ã€å¸–å­ã€è¯„è®ºã€äº’åŠ¨ç­‰ï¼‰
- `006_insert_community_default_data.sql` - ğŸ’¬ ç¤¾åŒºé»˜è®¤æ•°æ®ï¼ˆæ¿å—ã€æƒé™åˆ†é…ç­‰ï¼‰
- `007_add_vip_card_system.sql` - ğŸ’ VIPå¡å¯†ç³»ç»Ÿæ‰©å±•
- `008_add_points_checkin_system.sql` - ğŸ¯ ç§¯åˆ†ç­¾åˆ°ç³»ç»Ÿæ‰©å±•
- `009_add_vip_points_permissions.sql` - ğŸ›¡ï¸ VIPç§¯åˆ†æƒé™æ‰©å±•
- `010_add_permission_active_status.sql` - âœ… æƒé™æ¿€æ´»çŠ¶æ€æ‰©å±•

æœåŠ¡å¯åŠ¨åï¼Œè®¿é—®ï¼š
- **API æœåŠ¡**ï¼šhttp://localhost:3000
- **API æ–‡æ¡£**ï¼šhttp://localhost:3000/api-docs ï¼ˆSwagger UI äº¤äº’å¼æ–‡æ¡£ï¼‰
- **API æ¥å£åˆ—è¡¨**ï¼šhttp://localhost:3000/api ï¼ˆæ‰€æœ‰å¯ç”¨ç«¯ç‚¹æ¦‚è§ˆï¼‰
- **å¥åº·æ£€æŸ¥**ï¼šhttp://localhost:3000/health


## ğŸ¯ NPM è„šæœ¬å‘½ä»¤

| å‘½ä»¤ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| `npm start` | å¯åŠ¨ç”Ÿäº§æœåŠ¡ | ä½¿ç”¨ Node.js ç›´æ¥è¿è¡Œ |
| `npm run dev` | å¯åŠ¨å¼€å‘æœåŠ¡ | ä½¿ç”¨ nodemon è‡ªåŠ¨é‡å¯ |
| `npm run migrate` | ç”¨æˆ·ç³»ç»Ÿè¿ç§» | åˆ›å»ºç”¨æˆ·ã€è§’è‰²ã€æƒé™è¡¨ |
| `npm run migrate-cms` | CMS ç³»ç»Ÿè¿ç§» | åˆ›å»ºèµ„æºã€åˆ†ç±»ã€æ ‡ç­¾è¡¨ |
| `npm run migrate-community` | ç¤¾åŒºç³»ç»Ÿè¿ç§» | åˆ›å»ºæ¿å—ã€å¸–å­ã€è¯„è®ºã€äº’åŠ¨è¡¨ |
| `npm run create-admin` | åˆ›å»ºç®¡ç†å‘˜ | åˆ›å»ºåˆå§‹ç®¡ç†å‘˜è´¦æˆ· |
| `npm run test-api` | API è‡ªåŠ¨åŒ–æµ‹è¯• | æµ‹è¯•æ‰€æœ‰ API ç«¯ç‚¹ |

  # å¼€å‘ç¯å¢ƒé›†ç¾¤ï¼ˆ2è¿›ç¨‹ï¼‰
  npm run pm2:dev

  # ç”Ÿäº§ç¯å¢ƒé›†ç¾¤ï¼ˆmaxè¿›ç¨‹ï¼‰
  npm run pm2:prod

  # ç®¡ç†å‘½ä»¤
  npm run pm2:status   # æŸ¥çœ‹çŠ¶æ€
  npm run pm2:logs     # æŸ¥çœ‹æ—¥å¿—  
  npm run pm2:monit    # æ€§èƒ½ç›‘æ§
  npm run pm2:restart  # é‡å¯
  npm run pm2:stop     # åœæ­¢